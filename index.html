<!DOCTYPE html>
<html lang="it">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Luce 1</title>
  <style>
    :root {
      color-scheme: light dark;
      --bg: #0c1116;
      --panel: #111827;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #22c55e;
      --danger: #ef4444;
      --border: #1f2937;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
      font-family: "Inter", system-ui, -apple-system, sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at 20% 20%, rgba(34, 197, 94, 0.12), transparent 35%), radial-gradient(circle at 80% 0%, rgba(239, 68, 68, 0.14), transparent 30%), var(--bg);
      display: grid;
      place-items: center;
      color: var(--text);
      padding: 2rem 1rem;
    }

    .card {
      width: min(320px, 100%);
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 20px;
      box-shadow: var(--shadow);
      padding: 2rem;
      text-align: center;
    }

    h1 {
      margin: 0 0 1.5rem;
      font-size: 1.8rem;
      letter-spacing: -0.02em;
      font-weight: 700;
    }

    .actions {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    button {
      appearance: none;
      border: none;
      border-radius: 16px;
      padding: 1.2rem 1rem;
      font-size: 1.1rem;
      font-weight: 700;
      color: #0b0f13;
      cursor: pointer;
      transition: transform 120ms ease, box-shadow 120ms ease, filter 120ms ease;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.18);
      width: 100%;
    }

    button:disabled {
      cursor: not-allowed;
      opacity: 0.6;
      filter: grayscale(0.25);
    }

    .btn-on {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      box-shadow: 0 8px 24px rgba(34, 197, 94, 0.25);
    }

    .btn-off {
      background: linear-gradient(135deg, #ef4444, #b91c1c);
      box-shadow: 0 8px 24px rgba(239, 68, 68, 0.23);
      color: #fff;
    }

    button:not(:disabled):hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.25);
    }

    button:not(:disabled):active {
      transform: translateY(0);
      filter: brightness(0.95);
    }

    .status {
      margin-top: 1.5rem;
      font-size: 0.85rem;
      color: var(--muted);
      min-height: 1.2em;
    }

    .status.error {
      color: var(--danger);
    }

    .status.success {
      color: var(--accent);
    }
  </style>
</head>

<body>
  <main class="card">
    <h1>Luce 1</h1>

    <div class="actions">
      <button class="btn-on" id="btn-on">ON</button>
      <button class="btn-off" id="btn-off">OFF</button>
    </div>

    <div class="status" id="status"></div>
  </main>

  <script>
    const CONFIG = {
      endpointOn: "https://raspberrypi.taild4c19b.ts.net/accendi_luce",
      endpointOff: "https://raspberrypi.taild4c19b.ts.net/spegni_luce",
      token: "Bearer dario-raspi-led-2025-super-token-9fA3k!"
    };

    const statusBox = document.getElementById("status");
    const btnOn = document.getElementById("btn-on");
    const btnOff = document.getElementById("btn-off");

    function setLoading(isLoading) {
      btnOn.disabled = isLoading;
      btnOff.disabled = isLoading;
    }

    function showStatus(message, type = "neutral") {
      statusBox.textContent = message;
      statusBox.className = "status " + type;

      if (type !== "neutral") {
        setTimeout(() => {
          statusBox.textContent = "";
          statusBox.className = "status";
        }, 3000);
      }
    }

    async function sendCommand(action) {
      const url = action === "on" ? CONFIG.endpointOn : CONFIG.endpointOff;
      setLoading(true);
      showStatus("Invio...", "neutral");

      try {
        const response = await fetch(url, {
          method: "POST",
          headers: {
            "Authorization": CONFIG.token,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({})
        });

        if (!response.ok) {
          const text = await response.text();
          throw new Error(`Errore ${response.status}: ${text}`);
        }

        showStatus("Fatto!", "success");
      } catch (error) {
        console.error(error);
        showStatus("Errore di connessione", "error");
      } finally {
        setLoading(false);
      }
    }

    btnOn.addEventListener("click", () => sendCommand("on"));
    btnOff.addEventListener("click", () => sendCommand("off"));
  </script>
</body>

</html>
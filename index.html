<!DOCTYPE html>
<html lang="it">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Luce 1</title>
  <style>
    :root {
      color-scheme: light dark;
      --bg: #0c1116;
      --panel: #111827;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #22c55e;
      --danger: #ef4444;
      --border: #1f2937;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
      font-family: "Inter", system-ui, -apple-system, sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at 20% 20%, rgba(34, 197, 94, 0.12), transparent 35%), radial-gradient(circle at 80% 0%, rgba(239, 68, 68, 0.14), transparent 30%), var(--bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 1.5rem;
      color: var(--text);
      padding: 2rem 1rem;
    }

    .card {
      width: min(220px, 100%);
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 1rem;
      text-align: center;
    }

    h1 {
      margin: 0 0 1rem;
      font-size: 1.2rem;
      letter-spacing: -0.02em;
      font-weight: 700;
    }

    .actions {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    .actions.single {
      grid-template-columns: 1fr;
    }

    button {
      appearance: none;
      border: none;
      border-radius: 10px;
      padding: 0.6rem 0.8rem;
      font-size: 0.85rem;
      font-weight: 700;
      color: #0b0f13;
      cursor: pointer;
      transition: transform 120ms ease, box-shadow 120ms ease, filter 120ms ease;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.18);
      width: 100%;
    }

    button:disabled {
      cursor: not-allowed;
      opacity: 0.6;
      filter: grayscale(0.25);
    }

    .btn-on {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      box-shadow: 0 8px 24px rgba(34, 197, 94, 0.25);
    }

    .btn-blink {
      background: linear-gradient(135deg, #3b82f6, #2563eb);
      box-shadow: 0 8px 24px rgba(59, 130, 246, 0.25);
      color: #fff;
    }

    .btn-off {
      background: linear-gradient(135deg, #ef4444, #b91c1c);
      box-shadow: 0 8px 24px rgba(239, 68, 68, 0.23);
      color: #fff;
    }

    button:not(:disabled):hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.25);
    }

    button:not(:disabled):active {
      transform: translateY(0);
      filter: brightness(0.95);
    }

    .status {
      margin-top: 1.5rem;
      font-size: 0.85rem;
      color: var(--muted);
      min-height: 1.2em;
    }

    .status.error {
      color: var(--danger);
    }

    .status.success {
      color: var(--accent);
    }

    #login-overlay {
      position: fixed;
      inset: 0;
      background: var(--bg);
      z-index: 1000;
      display: grid;
      place-items: center;
    }

    input {
      background: #0c121c;
      border: 1px solid var(--border);
      color: var(--text);
      padding: 1rem;
      border-radius: 12px;
      margin-bottom: 1rem;
      width: 100%;
      box-sizing: border-box;
      font-size: 1rem;
      outline: none;
    }

    input:focus {
      border-color: var(--accent);
    }

    #lights-row {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      gap: 1.5rem;
      justify-content: center;
      width: 100%;
      width: 100%;
      max-width: 1000px;
    }

    .hover-row {
      display: flex;
      gap: 1.5rem;
      justify-content: center;
      margin-bottom: 1rem;
    }

    .hover-bulb {
      font-size: 3rem;
      cursor: pointer;
      user-select: none;
      transition: transform 0.2s;
    }

    .hover-bulb:hover {
      transform: scale(1.2);
    }
  </style>
</head>

<body>
  <div id="login-overlay">
    <div class="card">
      <h1>Login</h1>
      <input type="text" id="username" placeholder="Username" />
      <input type="password" id="password" placeholder="Password" />
      <button class="btn-on" id="btn-login">Entra</button>
      <div id="login-error" class="status error"></div>
    </div>
  </div>

  <section class="card" style="width: 100%; max-width: 600px;">
    <h1>On Mouse Up (Hover)</h1>
    <div class="hover-row">
      <div class="hover-bulb" id="hov-1" title="Luce 1">ðŸŒ‘</div>
      <div class="hover-bulb" id="hov-2" title="Luce 2">ðŸŒ‘</div>
      <div class="hover-bulb" id="hov-3" title="Luce 3">ðŸŒ‘</div>
      <div class="hover-bulb" id="hov-4" title="Luce 4">ðŸŒ‘</div>
      <div class="hover-bulb" id="hov-5" title="Luce 5">ðŸŒ‘</div>
    </div>
    <div class="status" style="font-size: 0.8rem; margin-top: 0.5rem;">Passa il mouse sopra per accendere</div>
  </section>

  <div id="lights-row">
    <main class="card">
      <h1>Luce 1</h1>
      <div class="actions">
        <button class="btn-on" id="btn-on">ðŸŸ¢ ON</button>
        <button class="btn-off" id="btn-off">ðŸ”´ OFF</button>
      </div>
    </main>

    <section class="card">
      <h1>Luce 2</h1>
      <div class="actions">
        <button class="btn-on" id="btn-on-2">ðŸŸ¢ ON</button>
        <button class="btn-off" id="btn-off-2">ðŸ”´ OFF</button>
      </div>
    </section>

    <section class="card">
      <h1>Luce 3</h1>
      <div class="actions">
        <button class="btn-on" id="btn-on-3">ðŸŸ¢ ON</button>
        <button class="btn-off" id="btn-off-3">ðŸ”´ OFF</button>
      </div>
    </section>

    <section class="card">
      <h1>Luce 4</h1>
      <div class="actions">
        <button class="btn-on" id="btn-on-4">ðŸŸ¢ ON</button>
        <button class="btn-off" id="btn-off-4">ðŸ”´ OFF</button>
      </div>
    </section>

    <section class="card">
      <h1>Luce 5</h1>
      <div class="actions">
        <button class="btn-on" id="btn-on-5">ðŸŸ¢ ON</button>
        <button class="btn-off" id="btn-off-5">ðŸ”´ OFF</button>
      </div>
    </section>

    <div class="hover-row" style="width: 100%; flex-wrap: wrap;">
      <section class="card">
        <h1>On Press Luce 4</h1>
        <div class="actions single">
          <button class="btn-blink" id="btn-press-4">ðŸ‘† PREMI</button>
        </div>
      </section>

      <section class="card">
        <h1>On Press Luce 5</h1>
        <div class="actions single">
          <button class="btn-blink" id="btn-press-5">ðŸ‘† PREMI</button>
        </div>
      </section>
    </div>

    <h1 style="margin-top: 2rem;">Area Buzzer</h1>
    <div class="hover-row" style="width: 100%; flex-wrap: wrap;">
      <section class="card">
        <h1>Buzzer 1</h1>
        <div class="actions">
          <button class="btn-on" id="btn-buzz-on">ðŸŸ¢ ON</button>
          <button class="btn-off" id="btn-buzz-off">ðŸ”´ OFF</button>
        </div>
      </section>

      <section class="card">
        <h1>On Press Buzzer</h1>
        <div class="actions single">
          <button class="btn-blink" id="btn-buzz-press">ðŸ‘† PREMI</button>
        </div>
      </section>
    </div>
  </div>

  <section class="card">
    <h1>Test D&I</h1>

    <div style="margin-bottom: 1rem;">
      <select id="blink-selector" style="
            width: 100%;
            padding: 0.8rem;
            border-radius: 12px;
            background: #0c121c;
            border: 1px solid var(--border);
            color: var(--text);
            font-size: 1rem;
            outline: none;
        ">
        <option value="email">Email</option>
        <option value="high">HighImportance</option>
        <option value="msg">NewMessageInChannel</option>
        <option value="meeting">Meeting</option>
      </select>
    </div>

    <div class="actions single">
      <button class="btn-blink" id="btn-blink">ðŸš¨ Blink</button>
    </div>
  </section>

  <div class="status" id="status"></div>
  </div>

  <script>
    const CONFIG = {
      endpointOn: "https://raspberrypi.taild4c19b.ts.net/accendi_luce",
      endpointOff: "https://raspberrypi.taild4c19b.ts.net/spegni_luce",
      endpointOn2: "https://raspberrypi.taild4c19b.ts.net/accendi_luce2",
      endpointOff2: "https://raspberrypi.taild4c19b.ts.net/spegni_luce2",
      endpointOn3: "https://raspberrypi.taild4c19b.ts.net/accendi_luce3",
      endpointOff3: "https://raspberrypi.taild4c19b.ts.net/spegni_luce3",
      endpointOn4: "https://raspberrypi.taild4c19b.ts.net/accendi_luce4",
      endpointOff4: "https://raspberrypi.taild4c19b.ts.net/spegni_luce4",
      endpointOn5: "https://raspberrypi.taild4c19b.ts.net/accendi_luce5",
      endpointOff5: "https://raspberrypi.taild4c19b.ts.net/spegni_luce5",
      endpointEmail: "https://raspberrypi.taild4c19b.ts.net/email",
      endpointBuzzOn: "https://raspberrypi.taild4c19b.ts.net/buzz1on",
      endpointBuzzOff: "https://raspberrypi.taild4c19b.ts.net/buzz1off",
      endpointHigh: "https://raspberrypi.taild4c19b.ts.net/HighImportance",
      endpointMsg: "https://raspberrypi.taild4c19b.ts.net/NewMessageInChannel",
      endpointMeeting: "https://raspberrypi.taild4c19b.ts.net/meeting",
      token: "Bearer dario-raspi-led-2025-super-token-9fA3k!"
    };

    const statusBox = document.getElementById("status");
    const btnOn = document.getElementById("btn-on");
    const btnOff = document.getElementById("btn-off");
    const btnOn2 = document.getElementById("btn-on-2");
    const btnOff2 = document.getElementById("btn-off-2");
    const btnOn3 = document.getElementById("btn-on-3");
    const btnOff3 = document.getElementById("btn-off-3");
    const btnOn4 = document.getElementById("btn-on-4");
    const btnOff4 = document.getElementById("btn-off-4");
    const btnOn5 = document.getElementById("btn-on-5");
    const btnOff5 = document.getElementById("btn-off-5");
    const btnPress4 = document.getElementById("btn-press-4");
    const btnPress5 = document.getElementById("btn-press-5");
    const btnBuzzOn = document.getElementById("btn-buzz-on");
    const btnBuzzOff = document.getElementById("btn-buzz-off");
    const btnBuzzPress = document.getElementById("btn-buzz-press");
    const hov1 = document.getElementById("hov-1");
    const hov2 = document.getElementById("hov-2");
    const hov3 = document.getElementById("hov-3");
    const hov4 = document.getElementById("hov-4");
    const hov5 = document.getElementById("hov-5");
    const btnBlink = document.getElementById("btn-blink");
    const blinkSelector = document.getElementById("blink-selector");

    function setLoading(isLoading) {
      btnOn.disabled = isLoading;
      btnOff.disabled = isLoading;
      btnOn2.disabled = isLoading;
      btnOff2.disabled = isLoading;
      btnOn3.disabled = isLoading;
      btnOff3.disabled = isLoading;
      btnOn4.disabled = isLoading;
      btnOff4.disabled = isLoading;
      btnOn5.disabled = isLoading;
      btnOff5.disabled = isLoading;
      btnBuzzOn.disabled = isLoading;
      btnBuzzOff.disabled = isLoading;
      // Momentary buttons generally stay active to release
      btnBlink.disabled = isLoading;
      blinkSelector.disabled = isLoading;
    }

    function showStatus(message, type = "neutral") {
      statusBox.textContent = message;
      statusBox.className = "status " + type;

      if (type !== "neutral") {
        setTimeout(() => {
          statusBox.textContent = "";
          statusBox.className = "status";
        }, 3000);
      }
    }

    async function sendCommand(action) {
      let url;
      if (action === "on") url = CONFIG.endpointOn;
      else if (action === "off") url = CONFIG.endpointOff;
      else if (action === "on2") url = CONFIG.endpointOn2;
      else if (action === "off2") url = CONFIG.endpointOff2;
      else if (action === "on3") url = CONFIG.endpointOn3;
      else if (action === "off3") url = CONFIG.endpointOff3;
      else if (action === "on4") url = CONFIG.endpointOn4;
      else if (action === "off4") url = CONFIG.endpointOff4;
      else if (action === "on5") url = CONFIG.endpointOn5;
      else if (action === "off5") url = CONFIG.endpointOff5;
      else if (action === "buzzOn") url = CONFIG.endpointBuzzOn;
      else if (action === "buzzOff") url = CONFIG.endpointBuzzOff;
      else if (action === "email") url = CONFIG.endpointEmail;
      else if (action === "high") url = CONFIG.endpointHigh;
      else if (action === "msg") url = CONFIG.endpointMsg;
      else if (action === "meeting") url = CONFIG.endpointMeeting;

      setLoading(true);
      showStatus("Invio...", "neutral");

      try {
        const response = await fetch(url, {
          method: "POST",
          headers: {
            "Authorization": CONFIG.token,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({})
        });

        if (!response.ok) {
          const text = await response.text();
          throw new Error(`Errore ${response.status}: ${text}`);
        }

        // Removed "Fatto!" feedback as requested
        showStatus("");
      } catch (error) {
        console.error(error);
        showStatus("Errore di connessione", "error");
      } finally {
        setLoading(false);
      }
    }

    btnOn.addEventListener("click", () => sendCommand("on"));
    btnOff.addEventListener("click", () => sendCommand("off"));
    btnOn2.addEventListener("click", () => sendCommand("on2"));
    btnOff2.addEventListener("click", () => sendCommand("off2"));
    btnOn3.addEventListener("click", () => sendCommand("on3"));
    btnOff3.addEventListener("click", () => sendCommand("off3"));
    btnOn4.addEventListener("click", () => sendCommand("on4"));
    btnOff4.addEventListener("click", () => sendCommand("off4"));
    btnOn5.addEventListener("click", () => sendCommand("on5"));
    btnOff5.addEventListener("click", () => sendCommand("off5"));
    btnBuzzOn.addEventListener("click", () => sendCommand("buzzOn"));
    btnBuzzOff.addEventListener("click", () => sendCommand("buzzOff"));

    // Momentary Switch Logic
    function addMomentarySwitch(btn, actionOn, actionOff) {
      const start = (e) => {
        e.preventDefault();
        sendCommand(actionOn);
      };
      const end = (e) => {
        e.preventDefault();
        sendCommand(actionOff);
      };

      btn.addEventListener("mousedown", start);
      btn.addEventListener("mouseup", end);
      btn.addEventListener("mouseleave", end);
      btn.addEventListener("touchstart", start);
      btn.addEventListener("touchend", end);
    }

    addMomentarySwitch(btnPress4, "on4", "off4");
    addMomentarySwitch(btnPress5, "on5", "off5");
    addMomentarySwitch(btnBuzzPress, "buzzOn", "buzzOff");

    // Hover Switch Logic
    function addHoverSwitch(el, actionOn, actionOff) {
      const on = () => {
        el.textContent = "ðŸ’¡";
        sendCommand(actionOn);
      };
      const off = () => {
        el.textContent = "ðŸŒ‘";
        sendCommand(actionOff);
      };

      el.addEventListener("mouseenter", on);
      el.addEventListener("mouseleave", off);
      // Mobile support (touch)
      el.addEventListener("touchstart", (e) => { e.preventDefault(); on(); });
      el.addEventListener("touchend", (e) => { e.preventDefault(); off(); });
    }

    addHoverSwitch(hov1, "on", "off");
    addHoverSwitch(hov2, "on2", "off2");
    addHoverSwitch(hov3, "on3", "off3");
    addHoverSwitch(hov4, "on4", "off4");
    addHoverSwitch(hov5, "on5", "off5");

    btnBlink.addEventListener("click", () => {
      const selection = blinkSelector.value;
      sendCommand(selection);
    });

    // Login Logic
    const loginOverlay = document.getElementById("login-overlay");
    const appContent = document.getElementById("app-content");
    const btnLogin = document.getElementById("btn-login");
    const userInput = document.getElementById("username");
    const passInput = document.getElementById("password");
    const loginError = document.getElementById("login-error");

    function checkLogin() {
      const u = userInput.value;
      const p = passInput.value;

      if (u === "admin" && p === "luci2025") {
        loginOverlay.style.display = "none";
        appContent.style.display = "flex";
      } else {
        loginError.textContent = "Credenziali errate";
        setTimeout(() => loginError.textContent = "", 2000);
      }
    }

    btnLogin.addEventListener("click", checkLogin);
    passInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") checkLogin();
    });
  </script>
</body>

</html>